---
layout: default
title: IKS Vulnerability Scan Issue Management
type: Process
parent: Policies & Processess
---

Process
{: .label .label-green}

# IKS & Satellite image vulnerability management process

## Purpose

Automated daily Vulnerability Advisor scans of container images are run using auditree for 
- IBM Cloud Kubernetes Service (IKS) control plane and cruiser clusters
- IBM Cloud Satellite

The automation raises github issues for new vulnerability findings, external and unsupported images.  These issues should be monitored and managed through to completion in a timely manner using the process described below.


## Scope

This policy applies to the infrastructure required to support the development and operations of IKS and Saltellite.

## Process

### Roles

The IKS/Satellite development/SRE squads are responsible for monitoring new issues raised against images under their ownership, and managing the issues through to completion in a timely manner.

The Security/Compliance squad is responsible for ensuring the latest scan of each image has taken place within the last 7 days.

### Action

### Action for new image vulnerability issues

Vulnerability findings are created in github repos:
- [IKS](https://github.ibm.com/alchemy-containers/compliance-armada-prod-vulnerabilities/issues?q=is%3Aissue+is%3Aopen+label%3Avulnerable-image)
- [Satellite](https://github.ibm.com/alchemy-containers/compliance-satellite-prod-vulnerabilities/issues?q=is%3Aissue+is%3Aopen+label%3Avulnerable-image) 

1. Owning squads monitor for new issues created by the scanner on a daily basis.  
- If squads have configured a compliance owner label for their images they can use the owner label to list the backlog of open issues owned by their squad e.g
 [armada-deploy squad example](https://github.ibm.com/alchemy-containers/compliance-satellite-prod-vulnerabilities/issues?q=is%3Aissue+is%3Aopen+label%3Aowner%3Aibm-armada-deploy)
- Squads who have not configured a compliance owner label for their images must identify issues owned by their squad by some other means

2. Owning squads are responsible for rolling out image vulnerability fixes and ensuring vulnerabilitiy issues are closed by the due date specified in the issue.  
- Squads may close off issues created by automation after rolling out their fixes but the automation will re-open them if the image is still present in the environment when the next scan runs.  In these circumstances the owning squad should perform investigation and engage other squads to resolve as required.
- For BOM images, if a newer replacement image with a fix HAS been rolled out everywhere, request an exemption for the old image by following the [IKS Vulnerability Scan Exemptions Process](https://github.ibm.com/alchemy-conductors/documentation-pages/blob/master/docs/process/iks_vuln_scan_exemptions.md)
  
3.  The scanner calculates due dates based on the [IBM Cloud Platform Security Policy](https://pages.github.ibm.com/ibmcloud/Security/policy/RA-Policy.html#remediation)
- Issues must be addressed and fixes deployed by the due date. 
- If the due date cannot be met squads must submit a [PCE request issue](https://github.ibm.com/alchemy-conductors/security/issues/new?assignees=&labels=Compliance%2C+Risk+Request%2C+PCE+Request&template=new-exception-risk-request.md&title=) to request a date extension. Extension requests must be submitted at least 3 business days BEFORE the due date and only in exceptional circumstances where there is a justified technical reason why the due date cannot be met.  Workload and/or alternative priorties are not acceptable reasons for an exception and may get rejected by CISO.  Extension requests must be submitted as soon as you think the dates are at risk to allow time for the approval process. 

4.  The scanner will automatically close off a vulnerability issue when the image is no longer detected in the environment or there is an approved and fully processed exemption in place.

### Action for new unsupported image issues

Issues associated with images unsupported by VA are labelled `unsupported-image`
- Unsupported images need to be approved into an `allowed list` and their dependencies added to PSIRT so that image vulnerabilities are tracked via the PSIRT process.  
- The process for adding images to the `allowed list` and their dependencies to PSIRT is intiated by [submitting a request here](https://github.ibm.com/alchemy-conductors/security/issues/new?assignees=&labels=Compliance%2C+unsupported-image&template=unsupported-image-approval-request.md&title=Unsupported+image+approval+request)
- New versions of unsupported images require a new approval request. This applies to patches, minor and major releases.
- After the request has been approved:
  - the images will be added to an `allowed list`
  - the dependencies will be added to the PSIRT tool
  - the PSIRT process will come into effect for the images
  - `unsupported-image` issues will close


### Action for new external image issues

External images are not permitted and should be removed from the environment as soon as they are detected.  In exceptional circumstances, where they cannot technically be removed, the process for unsupported images must be followed.

### Action for late (expired) scans

If the latest vulnerability scan for any image is more than 7 days old, the security/compliance squad will treat it as a scan failure and engage the Vulnerability Advisor team (Slack chennel `#registry-va-users`). 

### Image vulnerability reviews

The compliance team perform weekly image vulnerability reviews using the [process documented here](https://github.ibm.com/alchemy-conductors/compliance-team/blob/master/.github/ISSUE_TEMPLATE/image-vulnerability-review.md)


### Image vulnerability gaps

In the event that remediation timelines are not met with no extension request in place, the owning squad must do a root cause analysis (RCA). 
RCA guidance is [provided in the issue template](https://github.ibm.com/alchemy-conductors/security/blob/master/.github/ISSUE_TEMPLATE/root-cause-analysis.md)
The RCA process is typically triggered on detection of a gap by the compliance team
The owning manager of the impacted squad is responsible for timely completion and sign-off of the RCA

### Remediation timelines

Container images are subject to the [IBM Cloud policy remediation timelines documeted here](https://pages.github.ibm.com/ibmcloud/Security/policy/RA-Policy.html#remediation)
There are circumstances where IKS/Satellite is considered a consumer of IKS e.g the IKS carrier infrastucture is a consumer of the IKS BOMs.  In these situations additional remediation time is permitted as stated in the policy for consumers of IKS
The auditree scanning tool used to scan and report on image vulnerabilities calculates due date based on the extended remediation time permitted for consumers.  It does this by assuming that all armada-master images are subject to extended remediation times for consumers.  It is therefore critical that only images available to consumers are placed in the armada-master namespace.  All microservice images, for example, must be placed in the armada namespace.

### Exemptions

Exemption requests should be submitted for images when:
- a new version of the vulnerable image containing a fix has been rolled out
- they are no longer supported because the IKS/ROKS version they are in has gone out of support

## Process review

The process will be reviewed by Security Compliance squad management at least annually.

Last review: 2023-06-14 Last reviewer: Hannah Devlin Next review due by: 2024-06-14
